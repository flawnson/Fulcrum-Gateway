// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model Organizer {
  id Int @id @default(autoincrement())
  name String
  queues Queue[]
}

enum QueueState {
  ACTIVE
  PAUSED
  INACTIVE
}

model Queue {
  id Int @id @default(autoincrement())
  organizer_id Int
  organizer Organizer @relation(fields: [organizer_id], references: [id])
  join_code String
  name String
  state QueueState
  capacity Int
  max_party_size Int @default(1)
  grace_period Int?
  offline_time Int?
  enqueued User[]
  serviced User[]
  deferred User[]
  abandoned User[]
  noshows User[]
}

model User {
  id Int @id @default(autoincrement())
  name String
  queue_id Int
  queue Queue @relation(fields: [queue_id], references: [id])
  summoned Boolean @default(false)
  password String?
  phone_number String
  party_size Int @default(1)
  last_online DateTime
  index Int
  estimated_wait Int
  join_time DateTime
}
